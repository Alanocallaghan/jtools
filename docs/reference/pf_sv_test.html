<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test whether sampling weights are needed — pf_sv_test • jtools</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">jtools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/categorical.html">Plotting interactions among categorical variables in regression models</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Exploring interactions with continuous predictors in regression models</a>
    </li>
    <li>
      <a href="../articles/summ.html">Tools for summarizing and visualizing regression models</a>
    </li>
    <li>
      <a href="../articles/svycor.html">Calculate correlations and correlation tables with complex survey data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jacob-long/jtools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test whether sampling weights are needed</h1>
    </div>

    
    <p>Use the test proposed in Pfeffermann and Sverchkov (1999) to check whether
a regression model is specified correctly without weights.</p>
    

    <pre class="usage"><span class='fu'>pf_sv_test</span>(<span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>weights</span>, <span class='kw'>sims</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"jtools-digits"</span>, <span class='kw'>default</span> <span class='kw'>=</span> <span class='fl'>3</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>The fitted model, without weights</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data frame with the data fed to the fitted model and the weights</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>The name of the weights column in <code>model</code>'s data frame
or a vector of weights equal in length to the number of observations
included in <code>model</code>.</p></td>
    </tr>
    <tr>
      <th>sims</th>
      <td><p>The number of bootstrap simulations to use in estimating the
variance of the residual correlation. Default is 1000, but for publications
or when computing power/time is sufficient, a higher number is better.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>An integer specifying the number of digits past the decimal to
report in the output. Default is 3. You can change the default number of
digits for all jtools functions with
<code>options("jtools-digits" = digits)</code> where digits is the desired number.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a test described by Pfeffermann and Sverchkov (1999) that is
designed to help analysts decide whether they need to use sample weights
in their regressions to avoid biased parameter estimation.</p>
<p>It first checks the correlation of the residuals of the model with the
weights. It then uses bootstrapping to estimate the variance of the
correlation, ending with a t-test of whether the correlation differs from
zero. This is done for the squared residuals and cubed residuals as well.
If anyone of them are statistically significant (at whatever level you
feel appropriate), it is best to do a weighted regression. Note that in
large samples, a very small correlation may have a low p-value without a
large bias in the unweighted regression.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Pfeffermann, D., &amp; Sverchkov, M. (1999). Parametric and semi-parametric
 estimation of regression models fitted to survey data.
 <em>Sankhya: The Indian Journal of Statistics</em>, <em>61</em>. 166-186.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Other survey tools: <code><a href='svycor.html'>svycor</a></code>,
  <code><a href='svysd.html'>svysd</a></code>, <code><a href='weights_tests.html'>weights_tests</a></code>,
  <code><a href='wgttest.html'>wgttest</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Note: This is a contrived example to show how the function works,</span>
<span class='co'># not a case with actual sammpling weights from a survey vendor</span>
<span class='no'>states</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='no'>state.x77</span>)
<span class='fu'>set.seed</span>(<span class='fl'>100</span>)
<span class='no'>states</span>$<span class='no'>wts</span> <span class='kw'>&lt;-</span> <span class='fu'>runif</span>(<span class='fl'>50</span>, <span class='fl'>0</span>, <span class='fl'>3</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>(<span class='no'>Murder</span> ~ <span class='no'>Illiteracy</span> + <span class='no'>Frost</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>states</span>)
<span class='fu'>pf_sv_test</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>states</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>wts</span>, <span class='kw'>sims</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; 
#&gt; Pfeffermann-Sverchkov test of sample weight ignorability 
#&gt; 
#&gt; Residual correlation = -0.157, p = 0.343
#&gt; Squared residual correlation = 0.25, p = 0.159
#&gt; Cubed residual correlation = 0, p = 0.998
#&gt; 
#&gt; A significant correlation may indicate biased estimates in the unweighted model.</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jacob A. Long.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
